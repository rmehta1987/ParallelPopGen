<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Parallel PopGen Package: Simulation Models: Migration Group</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Parallel PopGen Package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__migration.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Simulation Models: Migration Group</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions that model migration rates over time (conservative model of migration)  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1migration__constant__equal.html">Sim_Model::migration_constant_equal</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: migration flows at rate <code>m</code> from pop <code>i</code> to pop <code>j =/= i</code> and <code>1-(num_pop-1)*m</code> for <code>i == j</code>  <a href="struct_sim___model_1_1migration__constant__equal.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1migration__constant__directional.html">Sim_Model::migration_constant_directional&lt; Functor_m1 &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: migration flows at rate <code>m</code> from <code>pop1</code> to <code>pop2</code> and function <code>rest</code> for all other migration rates  <a href="struct_sim___model_1_1migration__constant__directional.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1migration__piecewise.html">Sim_Model::migration_piecewise&lt; Functor_m1, Functor_m2 &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: migration function changes from <code>m1</code> to <code>m2</code> at generation <code>inflection_point</code>  <a href="struct_sim___model_1_1migration__piecewise.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions that model migration rates over time (conservative model of migration) </p>
<p>In the conservative model of migration, migration rate from population i to population j is expressed as the fraction of population <code>j</code> originally from <code>i</code>:<br />
</p><blockquote class="doxtable">
<p>e.g. in a 2 population model, a migration rate of <code>m<sub>ij</sub></code> <code>= 0.1</code> ==&gt; 10% of population <code>j</code> is originally from population <code>i</code> <br />
and the frequency, \(x_{mig,j}\), in the next generation of an allele is \(x_{mig,j} = 0.1*x_i + 0.9*x_j\) </p>
</blockquote>
<p>Thus, in general, the following must be true: \(\sum_{i=1}^n\) <code>m<sub>ij</sub></code> <code>= 1</code> (program will throw error elsewise). However the sum of migration rates FROM a population need not sum to anything in particular. This is also the set of functions that are used to specify a single population splitting into (two or more) populations. <br />
 <br />
 </p><h3>Writing your own Migration functions</h3>
<p>These can be functions or functors (or soon, with C++11 support, lambdas). However, the migration function must be of the form:<br />
</p><div class="fragment"><div class="line">__host__ __device__ <span class="keywordtype">float</span> your_function(<span class="keywordtype">int</span> population_FROM, <span class="keywordtype">int</span> population_TO, <span class="keywordtype">int</span> generation){ ... <span class="keywordflow">return</span> migration_rate; } </div></div><!-- fragment --><p> This returns the rate of migration from population <code>population_FROM</code> to population <code>population_TO</code> at generation <code>generation</code>. The <code>__host__</code> and <code>__device__</code> flags are to ensure the nvcc compiler knows the function must be compiled for both the host (CPU) and device (GPU). Because of these flags, the function must be defined in CUDA source file (*.cu) or declared/defined header file (*.h, *.hpp, *.cuh, etc...) which is included in a CUDA source file. Since this code will be compiled on the GPU, do not use dynamically allocated arrays in your function (e.g. <code>float * f = new float[5]</code>) unless you know CUDA. And even then avoid them as they will slow the code down (parameters have to be pulled from the GPU's global memory (vRAM), which is slow). Statically allocated arrays (e.g. <code>float f[5]</code>) are fine. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
