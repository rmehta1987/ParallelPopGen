<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Parallel PopGen Package: Simulation Models: Selection Group</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Parallel PopGen Package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__selection.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Simulation Models: Selection Group</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions that model selection coefficients (<code>s</code>) across populations and over time.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__constant.html">Sim_Model::selection_constant</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: models selection coefficient <code>s</code> as a constant across populations and over time  <a href="struct_sim___model_1_1selection__constant.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__linear__frequency__dependent.html">Sim_Model::selection_linear_frequency_dependent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: models selection coefficient as linearly dependent on frequency  <a href="struct_sim___model_1_1selection__linear__frequency__dependent.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__sine__wave.html">Sim_Model::selection_sine_wave</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: models selection as a sine wave through time  <a href="struct_sim___model_1_1selection__sine__wave.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__population__specific.html">Sim_Model::selection_population_specific&lt; Functor_sel, Functor_sel_pop &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: one population, <code>pop</code>, has a different, selection function, <code>s_pop</code>, all other have function <code>s</code>  <a href="struct_sim___model_1_1selection__population__specific.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise&lt; Functor_sel1, Functor_sel2 &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">functor: selection function changes from <code>s1</code> to <code>s2</code> at generation <code>inflection_point</code>  <a href="struct_sim___model_1_1selection__piecewise.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions that model selection coefficients (<code>s</code>) across populations and over time. </p>
<p>Selection coefficients are defined by:</p>
<table class="doxtable">
<tr>
<th>AA </th><th>Aa </th><th>aa  </th></tr>
<tr>
<td><code>1</code> </td><td><code>1+hs</code> </td><td><code>1+s</code> </td></tr>
</table>
<p>where <code>h</code> is the dominance coefficient and AA, Aa, aa represent the various alleles. Thus Effective Selection, <code>gamma</code>, is defined by <code>N_chromosome_e*s</code> which for outbreeding diploids is <code>2*N*s</code> and haploid is <code>N*s</code> where N is the number of individuals (as returned by demography functions). Diploids with inbreeding, <code>F</code>, will have an effective strength of selection, <code>gamma</code>, of <code>2*N*s/(1+F)</code>. See <a class="el" href="group__demography.html">Simulation Models: Demography Group</a> for more about effective population size in the simulation. Side note: if <code>gamma</code> is set to some float, <code>S*(1+F)</code>, <code>h=0.5</code> (co-dominant), and the population size is similarly scaled (i.e. <code>N*(1+F)</code>), then the effective selection in the simulation will be invariant with respect to inbreeding.</p>
<p>Minimum selection is <code>s &gt;= -1</code> (lethal). Currently the program will not throw an error if the selection is less than -1, but will simply take the <code>max(s,-1)</code>.</p>
<h3>Writing your own Selection functions</h3>
<p>These can be functions or functors (or soon, with C++11 support, lambdas). However, the selection function must be of the form:<br />
</p><div class="fragment"><div class="line">__device__ <span class="keywordtype">float</span> your_function(<span class="keywordtype">int</span> population, <span class="keywordtype">int</span> generation, <span class="keywordtype">float</span> freq){ ... <span class="keywordflow">return</span> selection_coeff; } </div></div><!-- fragment --><p> This returns the selection coefficient in population <code>population</code> at generation <code>generation</code> for a mutation at frequency <code>freq</code>. The <code>__device__</code> flag is to ensure the nvcc compiler knows the function must be compiled for the device (GPU). Because of this flag, the function must be defined in CUDA source file (*.cu) or declared/defined header file (*.h, *.hpp, *.cuh, etc...) which is included in a CUDA source file. Since this code will be compiled on the GPU, do not use dynamically allocated arrays in your function (e.g. <code>float * f = new float[5]</code>) unless you know CUDA. And even then avoid them as they will slow the code down (parameters have to be pulled from the GPU's global memory (vRAM), which is slow). Statically allocated arrays (e.g. <code>float f[5]</code>) are fine. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
